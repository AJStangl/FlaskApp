{% extends "base.html" %}
{% block content %}
    <div class="container">
        <h1>Generations Table</h1>
        <table>
            <thead>
            <tr>
                <th>PartitionKey</th>
                <th>Row key</th>
                <th>path</th>
                <th>prompt</th>
                <th>style</th>
                <th>title</th>
                <th>Action</th>
            </tr>
            </thead>
            <tbody>
            {% for item in data %}
                <tr>
                    <td>{{ item.PartitionKey }}</td>
                    <td>{{ item.Rowkey }}</td>
                    <td><img src="{{ item.path }}" alt="Image"></td>
                    <td>{{ item.prompt }}</td>
                    <td>{{ item.style }}</td>
                    <td>{{ item.title }}</td>
                    <td>
                        <button class="btn btn-primary" onclick="sendAction('{{ item.path}}, {{item.title }}')">SendToReddit</button>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    <div>
         <div>
              <label for="subreddit">Subreddit:</label>
              <input class="form-control" type="text" id="subreddit" name="subreddit">
          </div>
    </div>
    </div>
    <script>
        function sendAction(path, title) {
            var sub = document.getElementById("subreddit").value
            fetch('/generations/send_to_reddit', {
                method: 'POST',
                body: JSON.stringify({
                    path: path,
                    title: title,
                    sub: sub,
                }),
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then((response) => {
                console.log('Action sent to Flask backend!');
            }).catch((error) => {
                console.error('Error sending action to Flask backend:', error);
            });
        }
    </script>
{% endblock %}
