{% extends "base.html" %}

{% block content %}
    <div class="container">
        <div><p>number of images remaining: {{ num_remaining }}</p></div>
        <div class="image-container">
            <div class="image-wrapper" onclick="toggleFullScreen(this)">
                <img src={{ link }}>
                <div class="image-label">Original Image</div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="mb-3">
            <button id=accept class="btn btn-primary" onclick="accept()">Accept</button>
            <button id=reject class="btn btn-warning" onclick="reject()">Reject</button>
        </div>
        <div class="mb-3">
            <label for="id" class="form-label">Id</label>
            <input type="text" class="form-control" id="id" placeholder="{{ content.id }}" readonly>
        </div>
        <div class="mb-3">
            <label for="title" class="form-label">Title</label>
            <input type="text" class="form-control" id="title" placeholder="{{ content.title }}" readonly>
        </div>
        <div class="mb-3">
            <label for="subreddit" class="form-label">Subreddit</label>
            <input type="text" class="form-control" id="subreddit" placeholder="{{ content.subreddit }}" readonly>
        </div>
        <div class="mb-3">
            <label for="model" class="form-label">Model</label>
            <input type="text" class="form-control" id="model" placeholder="{{ content.model }}" readonly>
        </div>
        <div class="mb-3">
            <label for="caption" class="form-label">Caption</label>
            <textarea class="form-control" id="caption" rows="3">{{ content.caption }}</textarea>
        </div>
    </div>

    <script>
        function showImage() {
            $(".images img").click(function () {
                $("#full-image").attr("src", $(this).attr("src"));
                $('#image-viewer').show();
                return;
            });
        }

        function closeImage() {
            $("#image-viewer .close").click(function () {
                $('#image-viewer').hide();
                return;
            });
        }

        function accept() {
            sendRequest("accept")
        }

        function reject() {
            sendRequest("reject");
        }

        function sendRequest(status) {
            $.ajax({
                url: "/primary/curate/",
                type: "POST",
                header: {
                    "content-type": "application/json"
                },
                data: {
                    "id": "{{ content.id }}",
                    "caption": $("#caption").val(),
                    "action": status,
                    "subreddit": "{{ content.subreddit }}"
                },
                success: function (data) {
                    window.location.href = data.redirect;
                }
            });
        }

        function toggleFullScreen(element) {
            if (
                !document.fullscreenElement &&
                !document.mozFullScreenElement &&
                !document.webkitFullscreenElement &&
                !document.msFullscreenElement
            ) {
                if (element.requestFullscreen) {
                    element.requestFullscreen();
                } else if (element.mozRequestFullScreen) {
                    element.mozRequestFullScreen();
                } else if (element.webkitRequestFullscreen) {
                    element.webkitRequestFullscreen();
                } else if (element.msRequestFullscreen) {
                    element.msRequestFullscreen();
                }
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
        }
    </script>
    <style>
        .image-container {
            display: flex;
        }

        .image-container .image-wrapper {
            position: relative;
            width: 50%; /* Adjust this value as needed */
            height: auto;
        }

        .image-container img {
            width: 100%;
            height: auto;
        }

        .image-container .image-label {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            color: #fff;
            padding: 10px;
            text-align: center;
            font-size: 14px;
        }
    </style>
{% endblock %}