{% extends "base.html" %}

{% block content %}
    <div class="container">
        <div><p>number of images remaining: {{ num_remaining }}</p></div>
        <div class="image-container">
            <div class="image-wrapper" onclick="toggleFullScreen(this)">
                <img src={{ link }}>
                <div class="image-label">Original Image</div>
            </div>
        </div>
    </div>
    <div class="loading-container" hidden>
        <div class="loading-icon"></div>
    </div>
    <div class="container">
        <div class="mb-3">
            <button id=accept class="btn btn-primary" onclick="accept()">Accept</button>
            <button id=reject class="btn btn-warning" onclick="reject()">Reject</button>
        </div>
        <div class="mb-3">
            <label for="id" class="form-label">Id</label>
            <input type="text" class="form-control" id="id" placeholder="{{ content.id }}" readonly>
        </div>
        <div class="mb-3">
            <label for="title" class="form-label">Title</label>
            <input type="text" class="form-control" id="title" placeholder="{{ content.title }}" readonly>
        </div>
        <div class="mb-3">
            <label for="subreddit" class="form-label">Subreddit</label>
            <input type="text" class="form-control" id="subreddit" placeholder="{{ content.subreddit }}" readonly>
        </div>
        <div class="mb-3">
            <label for="model" class="form-label">Model</label>
            <input type="text" class="form-control" id="model" placeholder="{{ content.model }}" readonly>
        </div>
        <div class="mb-3">
            <label for="caption" class="form-label">Caption</label>
            <textarea class="form-control" id="caption" rows="3">{{ content.caption }}</textarea>
        </div>
    </div>

    <script>
        function accept() {
            sendRequest("accept")
            document.getElementsByClassName("loading-container")[0].hidden = false;
        }

        function reject() {
            sendRequest("reject");
        }

        function sendRequest(status) {
            var button = document.getElementById("accept");
            button.disabled = true;
            var button = document.getElementById("reject");
            button.disabled = true;
            $.ajax({
                url: "/primary/curate/",
                type: "POST",
                header: {
                    "content-type": "application/json"
                },
                data: {
                    "id": "{{ content.id }}",
                    "caption": $("#caption").val(),
                    "action": status,
                    "subreddit": "{{ content.subreddit }}"
                },
                success: function (data) {
                    window.location.href = data.redirect;
                }
            });
        }

    </script>
    <style>
        .loading-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .loading-icon {
            border: 8px solid #f3f3f3;
            border-top: 8px solid #3498db;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
{% endblock %}